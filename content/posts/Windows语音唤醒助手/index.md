---
date: '2025-09-04T00:46:44+08:00'
draft: false
title: 'Windowsè¯­éŸ³å”¤é†’åŠ©æ‰‹'
tags: ['æ‚è®°','é¡¹ç›®']
---

æœ€è¿‘é—²ç€æ— èŠéšä¾¿åšäº†ä¸€ä¸ª[windowsçš„è¯­éŸ³å”¤é†’åŠ©æ‰‹](https://github.com/wanghai673/WinAssistant/)ï¼Œä¸»è¦æ˜¯é—²å¹³å¸¸è¦å‡ºé—¨ï¼Œæˆ–è€…ä¸æ–¹ä¾¿çš„æ—¶å€™ï¼ˆæ¯”å¦‚è¿åŠ¨ã€èººåºŠä¸Šçš„æ—¶å€™ï¼‰ï¼Œå¯ä»¥å«ä¸€å£°ç”µè„‘å°±åšæˆ‘æƒ³è®©ä»–åšçš„å†…å®¹ï¼ˆå¯ä»¥è¿æ¥LLM/GUI agent/MCPç­‰ç­‰ï¼‰ã€‚

å†åŠ ä¸Šç°åœ¨GUIAgentå‘å±•çš„å¾ˆå¿«ï¼Œç½‘ä¸Šè¿˜æ²¡æœ‰è¯­éŸ³å”¤é†’å½¢å¼çš„é“¾æ¥ï¼Œä¹Ÿå°±è‡ªå·±æ­äº†ä¸€ä¸ªå‡ºæ¥ã€‚

ä¸‹é¢æ˜¯è¿™ä¸ªé¡¹ç›®çš„readmeã€‚



# WinAssistant â€“ Windows æœ¬åœ°è¯­éŸ³å”¤é†’ä¸è‡ªåŠ¨åŒ–æ‰§è¡Œ

ä¸€ä¸ªåœ¨ **Windows** ä¸Šè¿è¡Œçš„æœ¬åœ°è¯­éŸ³åŠ©æ‰‹ï¼š

- è¯´å‡ºå”¤é†’è¯ â†’ è¯†åˆ«ä½ çš„è¯­éŸ³ â†’ è‡ªåŠ¨æ‰§è¡Œè‡ªå®šä¹‰åŠ¨ä½œï¼ˆè„šæœ¬ã€GUI Agentã€MCP ç­‰ï¼‰ã€‚
- **å…¨ç¦»çº¿**ï¼ˆå”¤é†’+è¯†åˆ«å‡å¯ç¦»çº¿ï¼‰ï¼Œå³æ’å³ç”¨ï¼Œä¼˜å…ˆä½¿ç”¨è€³æœºéº¦å…‹é£ã€‚

## æ¼”ç¤ºè§†é¢‘

https://github.com/user-attachments/assets/a48b8e94-8b95-46eb-9aa5-a4085c2341c4

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **å¤šå”¤é†’è¯å¯é€‰ / å¯è‡ªå®šä¹‰**
  å†…ç½®å¤šç§å¸¸è§å”¤é†’è¯ï¼Œä¹Ÿå¯æ›¿æ¢ä¸ºä½ è®­ç»ƒçš„ `.ppn` æ–‡ä»¶ã€‚
- **æœ¬åœ°å”¤é†’ï¼šPicovoice Porcupine**
  è½»é‡ã€ä½å»¶è¿Ÿã€å¯é ï¼Œç¦»çº¿è¿è¡Œã€‚
- **è¯­éŸ³è¯†åˆ«ï¼šfast-whisper**
  å†…ç½®**å»å™ª**ã€**VAD ç«¯ç‚¹æ£€æµ‹**ï¼Œè‡ªåŠ¨åˆ¤æ–­â€œç”¨æˆ·æ˜¯å¦è¯´å®Œâ€ï¼Œå¯æŒ‰éœ€è°ƒèŠ‚æ¨¡å‹å¤§å°ï¼ˆé€Ÿåº¦/å‡†ç¡®åº¦æƒè¡¡ï¼‰ã€‚
- **è‡ªåŠ¨éŸ³é¢‘è®¾å¤‡é€‰æ‹©**
  è‡ªåŠ¨é€‰æ‹©å¯ç”¨çš„è¾“å…¥/è¾“å‡ºè®¾å¤‡ï¼Œ**ä¼˜å…ˆè€³æœº**ã€‚
- **å¯æ’æ‹”â€œå¤„ç†æ€â€**
  è¯†åˆ«åˆ°æ–‡æœ¬åè¿›å…¥ä½ çš„â€œå¤„ç†æ€â€ï¼ˆå¯è‡ªå®šä¹‰ï¼‰ï¼Œä¾‹å¦‚ï¼š

  - è°ƒç”¨ MCP / å·¥å…·è°ƒç”¨
  - è§¦å‘ GUI Agent
  - æ‰§è¡Œè„šæœ¬ã€æ‰“å¼€åº”ç”¨ã€æŸ¥è¯¢ä¿¡æ¯ç­‰

---

## ğŸ§  å·¥ä½œæµ / çŠ¶æ€æœº

```mermaid
stateDiagram-v2
    [*] --> ç©ºé—²æ€
    ç©ºé—²æ€ --> å”¤é†’æ€: è¯­éŸ³å”¤é†’
    å”¤é†’æ€ --> å¤„ç†æ€: ç”¨æˆ·è¯­éŸ³ç»“æŸ
    å¤„ç†æ€ --> ç©ºé—²æ€
    å”¤é†’æ€ --> ç©ºé—²æ€: ç”¨æˆ·é•¿æ—¶é—´æ— åº”ç­”
    ç©ºé—²æ€ --> ç©ºé—²æ€: ï¼ˆæŒç»­ç›‘å¬ï¼‰
```

> è¯´æ˜ï¼šå”¤é†’åè¿›å…¥å®æ—¶å¬å†™ï¼›è‹¥æ£€æµ‹åˆ°**é•¿æ—¶é—´é™éŸ³**åˆ™å›é€€åˆ°ç©ºé—²æ€ã€‚

---

## ğŸ“¦ ç›®å½•ç»“æ„

```text
WINASSISTANT/
â”œâ”€ model/
â”‚  â”œâ”€ å°æ™º.ppn                 # è‡ªå®šä¹‰/å†…ç½®å”¤é†’è¯ï¼ˆPorcupineï¼‰
â”‚  â””â”€ porcupine_params_zh.pv  # ä¸­æ–‡å‚æ•°
â”œâ”€ music/                     # ç³»ç»Ÿæç¤ºéŸ³
â”‚  â”œâ”€ ok.wav
â”‚  â”œâ”€ sorry.wav
â”‚  â””â”€ zai.wav
â”œâ”€ utils/
â”‚  â”œâ”€ player.py               # æ’­æ”¾å™¨ï¼šæ’­æ”¾æç¤ºéŸ³/åé¦ˆ
â”‚  â”œâ”€ reader.py               # è¯†åˆ«å™¨ï¼šfast-whisper + VAD
â”‚  â”œâ”€ rouser.py               # å”¤é†’ï¼šPorcupine æ¨ç†
â”‚  â””â”€ UIoperator.py           # å¤„ç†æ€æ¨¡æ¿ï¼ˆå¯è‡ªå®šä¹‰ï¼‰
â”œâ”€ .env                       # ç¯å¢ƒå˜é‡ï¼ˆè§ä¸‹ï¼‰
â”œâ”€ main.py                    # å…¥å£ï¼špython main.py
â””â”€ requirements.txt           # ä¾èµ–
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1) ç¯å¢ƒå‡†å¤‡

- Windows 10/11
- Python 3.9+ï¼ˆå»ºè®® 64-bitï¼‰
- éº¦å…‹é£ & æ‰¬å£°å™¨/è€³æœº

```bash
git clone https://github.com/wanghai673/WinAssistant
cd WINASSISTANT

# å»ºè®®ï¼šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
.\.venv\Scripts\activate

pip install -r requirements.txt
```

### 2) ç”³è¯· Picovoice Access Key

å‰å¾€ [https://picovoice.ai/](https://picovoice.ai/) å…è´¹è·å– `ACCESS_KEY`ã€‚

### 3) é…ç½® `.env`

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæˆ–ä¿®æ”¹ `.env`ï¼š

```env
ACCESS_KEY=ä½ çš„AccessKey
# å”¤é†’è¯ï¼ˆå¯é€‰ï¼šå°æ™º, hey google, grasshopper, computer, americano,
# bumblebee, hey barista, ok google, pico clock, porcupine,
# picovoice, jarvis, terminator, grapefruit, blueberry, alexa, hey siriï¼‰
ROUSE_WORD=å°æ™º
```

> æƒ³ç”¨è‡ªå®šä¹‰å”¤é†’è¯ï¼ŸæŠŠè®­ç»ƒå¥½çš„ `.ppn` æ–‡ä»¶æ”¾åˆ° `model/` å¹¶åœ¨ä»£ç /ENV ä¸­æŒ‡å‘å®ƒå³å¯ã€‚

### 4) è¿è¡Œ

```bash
python main.py
```

è¯´å‡ºå”¤é†’è¯ï¼ˆé»˜è®¤ **â€œå°æ™ºâ€**ï¼‰â†’ è¯´å‡ºå‘½ä»¤ â†’ å¬åˆ°æç¤ºéŸ³å¹¶æ‰§è¡Œã€‚

---

## ğŸ§© è‡ªå®šä¹‰â€œå¤„ç†æ€â€

è¯†åˆ«ç»“æœä¼šè¿›å…¥ä½ çš„â€œå¤„ç†æ€â€æ¨¡å—ï¼ˆç¤ºä¾‹ï¼š`utils/UIoperator.py`ï¼‰ã€‚
ä½ å¯ä»¥åœ¨è¿™é‡Œï¼š

- ä¸²æ¥ **MCP** å·¥å…·è°ƒç”¨
- é€šè¿‡ **GUI Agent** æ“ä½œæ¡Œé¢
- æ‰§è¡Œè„šæœ¬ / æ‰“å¼€åº”ç”¨ / ç³»ç»Ÿè‡ªåŠ¨åŒ–
- å›æ”¾ `music/ok.wav / sorry.wav` ä½œä¸ºåé¦ˆ

> å»ºè®®å°†ä¸šåŠ¡é€»è¾‘ä¸è¯­éŸ³ç®¡çº¿è§£è€¦ï¼šä¿ç•™ `player / reader / rouser` ä½œä¸ºé€šç”¨èƒ½åŠ›å±‚ï¼Œå¤„ç†æ€ä¸“æ³¨äºâ€œè¦åšä»€ä¹ˆâ€ã€‚

---

## âš™ï¸ å¸¸ç”¨è°ƒä¼˜ç‚¹

- **VAD/é™éŸ³é˜ˆå€¼**ï¼šåœ¨ `reader.py` ä¸­è°ƒæ•´ `MAX_SILENCE_SECS` ç­‰å‚æ•°ï¼Œå½±å“â€œè¯´å®Œå°±åœâ€çš„æ•æ„Ÿåº¦ã€‚
- **æ¨¡å‹å¤§å°**ï¼šæ ¹æ®æœºå™¨æ€§èƒ½åˆ‡æ¢ fast-whisper æ¨¡å‹ï¼ˆå°æ¨¡å‹æ›´å¿«ï¼Œå¤§æ¨¡å‹æ›´å‡†ï¼‰ã€‚
- **æç¤ºéŸ³å±è”½**ï¼šé€šè¿‡ `realtime_zh(..., beep_guard=0.5)` åæ‰å‰ 0.5s ç³»ç»Ÿâ€œæ»´â€å£°ï¼Œé¿å…å½±å“è¯†åˆ«ã€‚
- **éŸ³é¢‘è®¾å¤‡**ï¼šé»˜è®¤è‡ªåŠ¨é€‰æ‹©ï¼Œä¼˜å…ˆè€³æœºï¼›å¦‚éœ€å›ºå®šè®¾å¤‡ï¼Œå¯åœ¨ `player/reader` ä¸­æŒ‡å®šè®¾å¤‡ç´¢å¼•ã€‚

---

## ğŸ” éšç§ä¸æœ¬åœ°åŒ–

- å”¤é†’ä¸è¯†åˆ«å‡å¯**ç¦»çº¿**å®Œæˆï¼›éŸ³é¢‘ä¸ä¼šä¸Šä¼ åˆ°äº‘ç«¯ã€‚
- ä»…åœ¨ä½ æ˜¾å¼é…ç½®è”ç½‘æœåŠ¡æ—¶æ‰ä¼šäº§ç”Ÿå¤–éƒ¨è°ƒç”¨ã€‚

---

## ğŸ§ª ç®€å•ç¤ºä¾‹ï¼ˆä¼ªä»£ç ï¼‰

```python
# æç®€ç¤ºä¾‹ï¼šç›‘å¬å”¤é†’ â†’ è¯†åˆ«
from utils.player import Player
from utils.reader import Reader
from utils.rouser import Rouser
from pvrecorder import PvRecorder
from dotenv import load_dotenv
import os

load_dotenv()
ACCESS_KEY = os.getenv("ACCESS_KEY")
ROUSE_WORD = os.getenv("ROUSE_WORD", "å°æ™º")
DEVICE_INDEX = -1  # ä½¿ç”¨ç³»ç»Ÿé»˜è®¤è¾“å…¥è®¾å¤‡

rouser = Rouser(access_key=ACCESS_KEY, device_index=DEVICE_INDEX, keyword=ROUSE_WORD)
player = Player()
reader = Reader(device_index=DEVICE_INDEX)

recorder = PvRecorder(device_index=DEVICE_INDEX, frame_length=rouser.porcupine.frame_length)
recorder.start()
print(f"æ­£åœ¨ç›‘å¬å”¤é†’è¯ï¼šã€{ROUSE_WORD}ã€ (Ctrl+C é€€å‡º)")

while True:
    pcm = recorder.read()
    if rouser.process(pcm) >= 0:              # æ£€æµ‹åˆ°å”¤é†’
        player.play_voice(block=True)         # æç¤ºéŸ³
        text = reader.realtime_zh(rec_shared=recorder, beep_guard=0.0)
        if text:
            print("è¯†åˆ«æ–‡æœ¬ï¼š", text)
            player.play_voice(block=True, type="ok")
            # åœ¨è¿™é‡Œæ ¹æ® text æ‰§è¡ŒåŠ¨ä½œ...
        else:
            player.play_voice(block=True, type="sorry")
```

---

## ğŸ§¯ æ•…éšœæ’æŸ¥

- **æ²¡æœ‰ååº” / è®¾å¤‡å ç”¨**ï¼šæ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–åº”ç”¨å ç”¨éº¦å…‹é£ï¼›å°è¯•åœ¨ç³»ç»Ÿå£°éŸ³è®¾ç½®ä¸­å¯ç”¨è®¾å¤‡ã€‚
- **è¯†åˆ«æ…¢**ï¼šè¯•ç”¨æ›´å°çš„ fast-whisper æ¨¡å‹æˆ–å…³é—­å…¶ä»–é«˜å ç”¨ç¨‹åºã€‚
- **å”¤é†’ä¸çµæ•**ï¼šæ›´æ¢æ›´æ¸…æ™°çš„å”¤é†’è¯æ¨¡å‹ `.ppn`ï¼Œæˆ–åœ¨å®‰é™ç¯å¢ƒä¸‹æµ‹è¯•ã€‚
- **æç¤ºéŸ³è¢«è¯†åˆ«è¿›å»**ï¼šå¢å¤§ `beep_guard`ï¼ˆå¦‚ `0.7`ï¼‰ã€‚

---

## ğŸ™Œ è‡´è°¢

- [Picovoice Porcupine](https://picovoice.ai/)ï¼ˆæœ¬åœ°å”¤é†’ï¼‰
- [fast-whisper](https://github.com/guillaumekln/faster-whisper)ï¼ˆå¿«é€Ÿ ASRï¼‰
