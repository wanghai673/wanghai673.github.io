<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Windows语音唤醒助手 | Wanghai673 | 博客</title><meta name=keywords content="杂记,项目"><meta name=description content="最近闲着无聊随便做了一个windows的语音唤醒助手，主要是闲平常要出门，或者不方便的时候（比如运动、躺床上的时候），可以叫一声电脑就做我想让他做的内容（可以连接LLM/GUI agent/MCP等等）。
再加上现在GUIAgent发展的很快，网上还没有语音唤醒形式的链接，也就自己搭了一个出来。
下面是这个项目的readme。
WinAssistant – Windows 本地语音唤醒与自动化执行
一个在 Windows 上运行的本地语音助手：

说出唤醒词 → 识别你的语音 → 自动执行自定义动作（脚本、GUI Agent、MCP 等）。
全离线（唤醒+识别均可离线），即插即用，优先使用耳机麦克风。

演示视频
https://github.com/user-attachments/assets/a48b8e94-8b95-46eb-9aa5-a4085c2341c4
✨ 核心特性


多唤醒词可选 / 可自定义
内置多种常见唤醒词，也可替换为你训练的 .ppn 文件。


本地唤醒：Picovoice Porcupine
轻量、低延迟、可靠，离线运行。


语音识别：fast-whisper
内置去噪、VAD 端点检测，自动判断“用户是否说完”，可按需调节模型大小（速度/准确度权衡）。


自动音频设备选择
自动选择可用的输入/输出设备，优先耳机。


可插拔“处理态”
识别到文本后进入你的“处理态”（可自定义），例如：

调用 MCP / 工具调用
触发 GUI Agent
执行脚本、打开应用、查询信息等




🧠 工作流 / 状态机
stateDiagram-v2
    [*] --> 空闲态
    空闲态 --> 唤醒态: 语音唤醒
    唤醒态 --> 处理态: 用户语音结束
    处理态 --> 空闲态
    唤醒态 --> 空闲态: 用户长时间无应答
    空闲态 --> 空闲态: （持续监听）

说明：唤醒后进入实时听写；若检测到长时间静音则回退到空闲态。"><meta name=author content="Wanghai673"><link rel=canonical href=http://localhost:1313/posts/windows%E8%AF%AD%E9%9F%B3%E5%94%A4%E9%86%92%E5%8A%A9%E6%89%8B/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.e0ba3545db7c40d4a40a6600ba4c0ca0c92ea8e60a1c1f89a93f15fb7438773c.css integrity="sha256-4Lo1Rdt8QNSkCmYAukwMoMkuqOYKHB+JqT8V+3Q4dzw=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/images/dog.svg><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/images/dog.svg><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/images/dog.svg><link rel=apple-touch-icon href=http://localhost:1313/images/dog.svg><link rel=mask-icon href=http://localhost:1313/images/dog.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/windows%E8%AF%AD%E9%9F%B3%E5%94%A4%E9%86%92%E5%8A%A9%E6%89%8B/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css integrity=sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js integrity=sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk crossorigin=anonymous onload='window.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})'></script><meta property="og:url" content="http://localhost:1313/posts/windows%E8%AF%AD%E9%9F%B3%E5%94%A4%E9%86%92%E5%8A%A9%E6%89%8B/"><meta property="og:site_name" content="Wanghai673 | 博客"><meta property="og:title" content="Windows语音唤醒助手"><meta property="og:description" content="最近闲着无聊随便做了一个windows的语音唤醒助手，主要是闲平常要出门，或者不方便的时候（比如运动、躺床上的时候），可以叫一声电脑就做我想让他做的内容（可以连接LLM/GUI agent/MCP等等）。
再加上现在GUIAgent发展的很快，网上还没有语音唤醒形式的链接，也就自己搭了一个出来。
下面是这个项目的readme。
WinAssistant – Windows 本地语音唤醒与自动化执行 一个在 Windows 上运行的本地语音助手：
说出唤醒词 → 识别你的语音 → 自动执行自定义动作（脚本、GUI Agent、MCP 等）。 全离线（唤醒+识别均可离线），即插即用，优先使用耳机麦克风。 演示视频 https://github.com/user-attachments/assets/a48b8e94-8b95-46eb-9aa5-a4085c2341c4
✨ 核心特性 多唤醒词可选 / 可自定义 内置多种常见唤醒词，也可替换为你训练的 .ppn 文件。
本地唤醒：Picovoice Porcupine 轻量、低延迟、可靠，离线运行。
语音识别：fast-whisper 内置去噪、VAD 端点检测，自动判断“用户是否说完”，可按需调节模型大小（速度/准确度权衡）。
自动音频设备选择 自动选择可用的输入/输出设备，优先耳机。
可插拔“处理态” 识别到文本后进入你的“处理态”（可自定义），例如：
调用 MCP / 工具调用 触发 GUI Agent 执行脚本、打开应用、查询信息等 🧠 工作流 / 状态机 stateDiagram-v2 [*] --> 空闲态 空闲态 --> 唤醒态: 语音唤醒 唤醒态 --> 处理态: 用户语音结束 处理态 --> 空闲态 唤醒态 --> 空闲态: 用户长时间无应答 空闲态 --> 空闲态: （持续监听） 说明：唤醒后进入实时听写；若检测到长时间静音则回退到空闲态。"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-04T00:46:44+08:00"><meta property="article:modified_time" content="2025-09-04T00:46:44+08:00"><meta property="article:tag" content="杂记"><meta property="article:tag" content="项目"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Windows语音唤醒助手"><meta name=twitter:description content="最近闲着无聊随便做了一个windows的语音唤醒助手，主要是闲平常要出门，或者不方便的时候（比如运动、躺床上的时候），可以叫一声电脑就做我想让他做的内容（可以连接LLM/GUI agent/MCP等等）。
再加上现在GUIAgent发展的很快，网上还没有语音唤醒形式的链接，也就自己搭了一个出来。
下面是这个项目的readme。
WinAssistant – Windows 本地语音唤醒与自动化执行
一个在 Windows 上运行的本地语音助手：

说出唤醒词 → 识别你的语音 → 自动执行自定义动作（脚本、GUI Agent、MCP 等）。
全离线（唤醒+识别均可离线），即插即用，优先使用耳机麦克风。

演示视频
https://github.com/user-attachments/assets/a48b8e94-8b95-46eb-9aa5-a4085c2341c4
✨ 核心特性


多唤醒词可选 / 可自定义
内置多种常见唤醒词，也可替换为你训练的 .ppn 文件。


本地唤醒：Picovoice Porcupine
轻量、低延迟、可靠，离线运行。


语音识别：fast-whisper
内置去噪、VAD 端点检测，自动判断“用户是否说完”，可按需调节模型大小（速度/准确度权衡）。


自动音频设备选择
自动选择可用的输入/输出设备，优先耳机。


可插拔“处理态”
识别到文本后进入你的“处理态”（可自定义），例如：

调用 MCP / 工具调用
触发 GUI Agent
执行脚本、打开应用、查询信息等




🧠 工作流 / 状态机
stateDiagram-v2
    [*] --> 空闲态
    空闲态 --> 唤醒态: 语音唤醒
    唤醒态 --> 处理态: 用户语音结束
    处理态 --> 空闲态
    唤醒态 --> 空闲态: 用户长时间无应答
    空闲态 --> 空闲态: （持续监听）

说明：唤醒后进入实时听写；若检测到长时间静音则回退到空闲态。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Windows语音唤醒助手","item":"http://localhost:1313/posts/windows%E8%AF%AD%E9%9F%B3%E5%94%A4%E9%86%92%E5%8A%A9%E6%89%8B/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Windows语音唤醒助手","name":"Windows语音唤醒助手","description":"最近闲着无聊随便做了一个windows的语音唤醒助手，主要是闲平常要出门，或者不方便的时候（比如运动、躺床上的时候），可以叫一声电脑就做我想让他做的内容（可以连接LLM/GUI agent/MCP等等）。\n再加上现在GUIAgent发展的很快，网上还没有语音唤醒形式的链接，也就自己搭了一个出来。\n下面是这个项目的readme。\nWinAssistant – Windows 本地语音唤醒与自动化执行 一个在 Windows 上运行的本地语音助手：\n说出唤醒词 → 识别你的语音 → 自动执行自定义动作（脚本、GUI Agent、MCP 等）。 全离线（唤醒+识别均可离线），即插即用，优先使用耳机麦克风。 演示视频 https://github.com/user-attachments/assets/a48b8e94-8b95-46eb-9aa5-a4085c2341c4\n✨ 核心特性 多唤醒词可选 / 可自定义 内置多种常见唤醒词，也可替换为你训练的 .ppn 文件。\n本地唤醒：Picovoice Porcupine 轻量、低延迟、可靠，离线运行。\n语音识别：fast-whisper 内置去噪、VAD 端点检测，自动判断“用户是否说完”，可按需调节模型大小（速度/准确度权衡）。\n自动音频设备选择 自动选择可用的输入/输出设备，优先耳机。\n可插拔“处理态” 识别到文本后进入你的“处理态”（可自定义），例如：\n调用 MCP / 工具调用 触发 GUI Agent 执行脚本、打开应用、查询信息等 🧠 工作流 / 状态机 stateDiagram-v2 [*] --\u0026gt; 空闲态 空闲态 --\u0026gt; 唤醒态: 语音唤醒 唤醒态 --\u0026gt; 处理态: 用户语音结束 处理态 --\u0026gt; 空闲态 唤醒态 --\u0026gt; 空闲态: 用户长时间无应答 空闲态 --\u0026gt; 空闲态: （持续监听） 说明：唤醒后进入实时听写；若检测到长时间静音则回退到空闲态。\n","keywords":["杂记","项目"],"articleBody":"最近闲着无聊随便做了一个windows的语音唤醒助手，主要是闲平常要出门，或者不方便的时候（比如运动、躺床上的时候），可以叫一声电脑就做我想让他做的内容（可以连接LLM/GUI agent/MCP等等）。\n再加上现在GUIAgent发展的很快，网上还没有语音唤醒形式的链接，也就自己搭了一个出来。\n下面是这个项目的readme。\nWinAssistant – Windows 本地语音唤醒与自动化执行 一个在 Windows 上运行的本地语音助手：\n说出唤醒词 → 识别你的语音 → 自动执行自定义动作（脚本、GUI Agent、MCP 等）。 全离线（唤醒+识别均可离线），即插即用，优先使用耳机麦克风。 演示视频 https://github.com/user-attachments/assets/a48b8e94-8b95-46eb-9aa5-a4085c2341c4\n✨ 核心特性 多唤醒词可选 / 可自定义 内置多种常见唤醒词，也可替换为你训练的 .ppn 文件。\n本地唤醒：Picovoice Porcupine 轻量、低延迟、可靠，离线运行。\n语音识别：fast-whisper 内置去噪、VAD 端点检测，自动判断“用户是否说完”，可按需调节模型大小（速度/准确度权衡）。\n自动音频设备选择 自动选择可用的输入/输出设备，优先耳机。\n可插拔“处理态” 识别到文本后进入你的“处理态”（可自定义），例如：\n调用 MCP / 工具调用 触发 GUI Agent 执行脚本、打开应用、查询信息等 🧠 工作流 / 状态机 stateDiagram-v2 [*] --\u003e 空闲态 空闲态 --\u003e 唤醒态: 语音唤醒 唤醒态 --\u003e 处理态: 用户语音结束 处理态 --\u003e 空闲态 唤醒态 --\u003e 空闲态: 用户长时间无应答 空闲态 --\u003e 空闲态: （持续监听） 说明：唤醒后进入实时听写；若检测到长时间静音则回退到空闲态。\n📦 目录结构 WINASSISTANT/ ├─ model/ │ ├─ 小智.ppn # 自定义/内置唤醒词（Porcupine） │ └─ porcupine_params_zh.pv # 中文参数 ├─ music/ # 系统提示音 │ ├─ ok.wav │ ├─ sorry.wav │ └─ zai.wav ├─ utils/ │ ├─ player.py # 播放器：播放提示音/反馈 │ ├─ reader.py # 识别器：fast-whisper + VAD │ ├─ rouser.py # 唤醒：Porcupine 推理 │ └─ UIoperator.py # 处理态模板（可自定义） ├─ .env # 环境变量（见下） ├─ main.py # 入口：python main.py └─ requirements.txt # 依赖 🚀 快速开始 1) 环境准备 Windows 10/11 Python 3.9+（建议 64-bit） 麦克风 \u0026 扬声器/耳机 git clone https://github.com/wanghai673/WinAssistant cd WINASSISTANT # 建议：创建虚拟环境 python -m venv .venv .\\.venv\\Scripts\\activate pip install -r requirements.txt 2) 申请 Picovoice Access Key 前往 https://picovoice.ai/ 免费获取 ACCESS_KEY。\n3) 配置 .env 在项目根目录创建或修改 .env：\nACCESS_KEY=你的AccessKey # 唤醒词（可选：小智, hey google, grasshopper, computer, americano, # bumblebee, hey barista, ok google, pico clock, porcupine, # picovoice, jarvis, terminator, grapefruit, blueberry, alexa, hey siri） ROUSE_WORD=小智 想用自定义唤醒词？把训练好的 .ppn 文件放到 model/ 并在代码/ENV 中指向它即可。\n4) 运行 python main.py 说出唤醒词（默认 “小智”）→ 说出命令 → 听到提示音并执行。\n🧩 自定义“处理态” 识别结果会进入你的“处理态”模块（示例：utils/UIoperator.py）。 你可以在这里：\n串接 MCP 工具调用 通过 GUI Agent 操作桌面 执行脚本 / 打开应用 / 系统自动化 回放 music/ok.wav / sorry.wav 作为反馈 建议将业务逻辑与语音管线解耦：保留 player / reader / rouser 作为通用能力层，处理态专注于“要做什么”。\n⚙️ 常用调优点 VAD/静音阈值：在 reader.py 中调整 MAX_SILENCE_SECS 等参数，影响“说完就停”的敏感度。 模型大小：根据机器性能切换 fast-whisper 模型（小模型更快，大模型更准）。 提示音屏蔽：通过 realtime_zh(..., beep_guard=0.5) 吞掉前 0.5s 系统“滴”声，避免影响识别。 音频设备：默认自动选择，优先耳机；如需固定设备，可在 player/reader 中指定设备索引。 🔐 隐私与本地化 唤醒与识别均可离线完成；音频不会上传到云端。 仅在你显式配置联网服务时才会产生外部调用。 🧪 简单示例（伪代码） # 极简示例：监听唤醒 → 识别 from utils.player import Player from utils.reader import Reader from utils.rouser import Rouser from pvrecorder import PvRecorder from dotenv import load_dotenv import os load_dotenv() ACCESS_KEY = os.getenv(\"ACCESS_KEY\") ROUSE_WORD = os.getenv(\"ROUSE_WORD\", \"小智\") DEVICE_INDEX = -1 # 使用系统默认输入设备 rouser = Rouser(access_key=ACCESS_KEY, device_index=DEVICE_INDEX, keyword=ROUSE_WORD) player = Player() reader = Reader(device_index=DEVICE_INDEX) recorder = PvRecorder(device_index=DEVICE_INDEX, frame_length=rouser.porcupine.frame_length) recorder.start() print(f\"正在监听唤醒词：『{ROUSE_WORD}』 (Ctrl+C 退出)\") while True: pcm = recorder.read() if rouser.process(pcm) \u003e= 0: # 检测到唤醒 player.play_voice(block=True) # 提示音 text = reader.realtime_zh(rec_shared=recorder, beep_guard=0.0) if text: print(\"识别文本：\", text) player.play_voice(block=True, type=\"ok\") # 在这里根据 text 执行动作... else: player.play_voice(block=True, type=\"sorry\") 🧯 故障排查 没有反应 / 设备占用：检查是否有其他应用占用麦克风；尝试在系统声音设置中启用设备。 识别慢：试用更小的 fast-whisper 模型或关闭其他高占用程序。 唤醒不灵敏：更换更清晰的唤醒词模型 .ppn，或在安静环境下测试。 提示音被识别进去：增大 beep_guard（如 0.7）。 🙌 致谢 Picovoice Porcupine（本地唤醒） fast-whisper（快速 ASR） ","wordCount":"386","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-09-04T00:46:44+08:00","dateModified":"2025-09-04T00:46:44+08:00","author":{"@type":"Person","name":"Wanghai673"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/windows%E8%AF%AD%E9%9F%B3%E5%94%A4%E9%86%92%E5%8A%A9%E6%89%8B/"},"publisher":{"@type":"Organization","name":"Wanghai673 | 博客","logo":{"@type":"ImageObject","url":"http://localhost:1313/images/dog.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Wanghai673 | 博客 (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Wanghai673 | 博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/tags/ title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=http://localhost:1313/search/ title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li><a href=http://localhost:1313/about/ title="🙋 关于"><span>🙋 关于</span></a></li><li><a href=http://localhost:1313/archives/ title="📚 归档"><span>📚 归档</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Windows语音唤醒助手</h1><div class=post-meta><span title='2025-09-04 00:46:44 +0800 CST'>2025年09月04日</span>&nbsp;|&nbsp;<a href=https://github.com/wanghai673/wanghai673.github.io/tree/main/content/posts/Windows%e8%af%ad%e9%9f%b3%e5%94%a4%e9%86%92%e5%8a%a9%e6%89%8b/index.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>最近闲着无聊随便做了一个<a href=https://github.com/wanghai673/WinAssistant/>windows的语音唤醒助手</a>，主要是闲平常要出门，或者不方便的时候（比如运动、躺床上的时候），可以叫一声电脑就做我想让他做的内容（可以连接LLM/GUI agent/MCP等等）。</p><p>再加上现在GUIAgent发展的很快，网上还没有语音唤醒形式的链接，也就自己搭了一个出来。</p><p>下面是这个项目的readme。</p><h1 id=winassistant--windows-本地语音唤醒与自动化执行>WinAssistant – Windows 本地语音唤醒与自动化执行<a hidden class=anchor aria-hidden=true href=#winassistant--windows-本地语音唤醒与自动化执行>#</a></h1><p>一个在 <strong>Windows</strong> 上运行的本地语音助手：</p><ul><li>说出唤醒词 → 识别你的语音 → 自动执行自定义动作（脚本、GUI Agent、MCP 等）。</li><li><strong>全离线</strong>（唤醒+识别均可离线），即插即用，优先使用耳机麦克风。</li></ul><h2 id=演示视频>演示视频<a hidden class=anchor aria-hidden=true href=#演示视频>#</a></h2><p><a href=https://github.com/user-attachments/assets/a48b8e94-8b95-46eb-9aa5-a4085c2341c4>https://github.com/user-attachments/assets/a48b8e94-8b95-46eb-9aa5-a4085c2341c4</a></p><h2 id=-核心特性>✨ 核心特性<a hidden class=anchor aria-hidden=true href=#-核心特性>#</a></h2><ul><li><p><strong>多唤醒词可选 / 可自定义</strong>
内置多种常见唤醒词，也可替换为你训练的 <code>.ppn</code> 文件。</p></li><li><p><strong>本地唤醒：Picovoice Porcupine</strong>
轻量、低延迟、可靠，离线运行。</p></li><li><p><strong>语音识别：fast-whisper</strong>
内置<strong>去噪</strong>、<strong>VAD 端点检测</strong>，自动判断“用户是否说完”，可按需调节模型大小（速度/准确度权衡）。</p></li><li><p><strong>自动音频设备选择</strong>
自动选择可用的输入/输出设备，<strong>优先耳机</strong>。</p></li><li><p><strong>可插拔“处理态”</strong>
识别到文本后进入你的“处理态”（可自定义），例如：</p><ul><li>调用 MCP / 工具调用</li><li>触发 GUI Agent</li><li>执行脚本、打开应用、查询信息等</li></ul></li></ul><hr><h2 id=-工作流--状态机>🧠 工作流 / 状态机<a hidden class=anchor aria-hidden=true href=#-工作流--状态机>#</a></h2><pre tabindex=0><code class=language-mermaid data-lang=mermaid>stateDiagram-v2
    [*] --&gt; 空闲态
    空闲态 --&gt; 唤醒态: 语音唤醒
    唤醒态 --&gt; 处理态: 用户语音结束
    处理态 --&gt; 空闲态
    唤醒态 --&gt; 空闲态: 用户长时间无应答
    空闲态 --&gt; 空闲态: （持续监听）
</code></pre><blockquote><p>说明：唤醒后进入实时听写；若检测到<strong>长时间静音</strong>则回退到空闲态。</p></blockquote><hr><h2 id=-目录结构>📦 目录结构<a hidden class=anchor aria-hidden=true href=#-目录结构>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>WINASSISTANT/
</span></span><span class=line><span class=cl>├─ model/
</span></span><span class=line><span class=cl>│  ├─ 小智.ppn                 # 自定义/内置唤醒词（Porcupine）
</span></span><span class=line><span class=cl>│  └─ porcupine_params_zh.pv  # 中文参数
</span></span><span class=line><span class=cl>├─ music/                     # 系统提示音
</span></span><span class=line><span class=cl>│  ├─ ok.wav
</span></span><span class=line><span class=cl>│  ├─ sorry.wav
</span></span><span class=line><span class=cl>│  └─ zai.wav
</span></span><span class=line><span class=cl>├─ utils/
</span></span><span class=line><span class=cl>│  ├─ player.py               # 播放器：播放提示音/反馈
</span></span><span class=line><span class=cl>│  ├─ reader.py               # 识别器：fast-whisper + VAD
</span></span><span class=line><span class=cl>│  ├─ rouser.py               # 唤醒：Porcupine 推理
</span></span><span class=line><span class=cl>│  └─ UIoperator.py           # 处理态模板（可自定义）
</span></span><span class=line><span class=cl>├─ .env                       # 环境变量（见下）
</span></span><span class=line><span class=cl>├─ main.py                    # 入口：python main.py
</span></span><span class=line><span class=cl>└─ requirements.txt           # 依赖
</span></span></code></pre></div><hr><h2 id=-快速开始>🚀 快速开始<a hidden class=anchor aria-hidden=true href=#-快速开始>#</a></h2><h3 id=1-环境准备>1) 环境准备<a hidden class=anchor aria-hidden=true href=#1-环境准备>#</a></h3><ul><li>Windows 10/11</li><li>Python 3.9+（建议 64-bit）</li><li>麦克风 & 扬声器/耳机</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/wanghai673/WinAssistant
</span></span><span class=line><span class=cl><span class=nb>cd</span> WINASSISTANT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 建议：创建虚拟环境</span>
</span></span><span class=line><span class=cl>python -m venv .venv
</span></span><span class=line><span class=cl>.<span class=se>\.</span>venv<span class=se>\S</span>cripts<span class=se>\a</span>ctivate
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>pip install -r requirements.txt
</span></span></code></pre></div><h3 id=2-申请-picovoice-access-key>2) 申请 Picovoice Access Key<a hidden class=anchor aria-hidden=true href=#2-申请-picovoice-access-key>#</a></h3><p>前往 <a href=https://picovoice.ai/>https://picovoice.ai/</a> 免费获取 <code>ACCESS_KEY</code>。</p><h3 id=3-配置-env>3) 配置 <code>.env</code><a hidden class=anchor aria-hidden=true href=#3-配置-env>#</a></h3><p>在项目根目录创建或修改 <code>.env</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-env data-lang=env><span class=line><span class=cl><span class=nv>ACCESS_KEY</span><span class=o>=</span>你的AccessKey
</span></span><span class=line><span class=cl><span class=c1># 唤醒词（可选：小智, hey google, grasshopper, computer, americano,</span>
</span></span><span class=line><span class=cl><span class=c1># bumblebee, hey barista, ok google, pico clock, porcupine,</span>
</span></span><span class=line><span class=cl><span class=c1># picovoice, jarvis, terminator, grapefruit, blueberry, alexa, hey siri）</span>
</span></span><span class=line><span class=cl><span class=nv>ROUSE_WORD</span><span class=o>=</span>小智
</span></span></code></pre></div><blockquote><p>想用自定义唤醒词？把训练好的 <code>.ppn</code> 文件放到 <code>model/</code> 并在代码/ENV 中指向它即可。</p></blockquote><h3 id=4-运行>4) 运行<a hidden class=anchor aria-hidden=true href=#4-运行>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python main.py
</span></span></code></pre></div><p>说出唤醒词（默认 <strong>“小智”</strong>）→ 说出命令 → 听到提示音并执行。</p><hr><h2 id=-自定义处理态>🧩 自定义“处理态”<a hidden class=anchor aria-hidden=true href=#-自定义处理态>#</a></h2><p>识别结果会进入你的“处理态”模块（示例：<code>utils/UIoperator.py</code>）。
你可以在这里：</p><ul><li>串接 <strong>MCP</strong> 工具调用</li><li>通过 <strong>GUI Agent</strong> 操作桌面</li><li>执行脚本 / 打开应用 / 系统自动化</li><li>回放 <code>music/ok.wav / sorry.wav</code> 作为反馈</li></ul><blockquote><p>建议将业务逻辑与语音管线解耦：保留 <code>player / reader / rouser</code> 作为通用能力层，处理态专注于“要做什么”。</p></blockquote><hr><h2 id=-常用调优点>⚙️ 常用调优点<a hidden class=anchor aria-hidden=true href=#-常用调优点>#</a></h2><ul><li><strong>VAD/静音阈值</strong>：在 <code>reader.py</code> 中调整 <code>MAX_SILENCE_SECS</code> 等参数，影响“说完就停”的敏感度。</li><li><strong>模型大小</strong>：根据机器性能切换 fast-whisper 模型（小模型更快，大模型更准）。</li><li><strong>提示音屏蔽</strong>：通过 <code>realtime_zh(..., beep_guard=0.5)</code> 吞掉前 0.5s 系统“滴”声，避免影响识别。</li><li><strong>音频设备</strong>：默认自动选择，优先耳机；如需固定设备，可在 <code>player/reader</code> 中指定设备索引。</li></ul><hr><h2 id=-隐私与本地化>🔐 隐私与本地化<a hidden class=anchor aria-hidden=true href=#-隐私与本地化>#</a></h2><ul><li>唤醒与识别均可<strong>离线</strong>完成；音频不会上传到云端。</li><li>仅在你显式配置联网服务时才会产生外部调用。</li></ul><hr><h2 id=-简单示例伪代码>🧪 简单示例（伪代码）<a hidden class=anchor aria-hidden=true href=#-简单示例伪代码>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 极简示例：监听唤醒 → 识别</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>utils.player</span> <span class=kn>import</span> <span class=n>Player</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>utils.reader</span> <span class=kn>import</span> <span class=n>Reader</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>utils.rouser</span> <span class=kn>import</span> <span class=n>Rouser</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pvrecorder</span> <span class=kn>import</span> <span class=n>PvRecorder</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dotenv</span> <span class=kn>import</span> <span class=n>load_dotenv</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>load_dotenv</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ACCESS_KEY</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;ACCESS_KEY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ROUSE_WORD</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;ROUSE_WORD&#34;</span><span class=p>,</span> <span class=s2>&#34;小智&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>DEVICE_INDEX</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>  <span class=c1># 使用系统默认输入设备</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rouser</span> <span class=o>=</span> <span class=n>Rouser</span><span class=p>(</span><span class=n>access_key</span><span class=o>=</span><span class=n>ACCESS_KEY</span><span class=p>,</span> <span class=n>device_index</span><span class=o>=</span><span class=n>DEVICE_INDEX</span><span class=p>,</span> <span class=n>keyword</span><span class=o>=</span><span class=n>ROUSE_WORD</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>player</span> <span class=o>=</span> <span class=n>Player</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>reader</span> <span class=o>=</span> <span class=n>Reader</span><span class=p>(</span><span class=n>device_index</span><span class=o>=</span><span class=n>DEVICE_INDEX</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>recorder</span> <span class=o>=</span> <span class=n>PvRecorder</span><span class=p>(</span><span class=n>device_index</span><span class=o>=</span><span class=n>DEVICE_INDEX</span><span class=p>,</span> <span class=n>frame_length</span><span class=o>=</span><span class=n>rouser</span><span class=o>.</span><span class=n>porcupine</span><span class=o>.</span><span class=n>frame_length</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>recorder</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;正在监听唤醒词：『</span><span class=si>{</span><span class=n>ROUSE_WORD</span><span class=si>}</span><span class=s2>』 (Ctrl+C 退出)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pcm</span> <span class=o>=</span> <span class=n>recorder</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>rouser</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>pcm</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>              <span class=c1># 检测到唤醒</span>
</span></span><span class=line><span class=cl>        <span class=n>player</span><span class=o>.</span><span class=n>play_voice</span><span class=p>(</span><span class=n>block</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>         <span class=c1># 提示音</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span> <span class=o>=</span> <span class=n>reader</span><span class=o>.</span><span class=n>realtime_zh</span><span class=p>(</span><span class=n>rec_shared</span><span class=o>=</span><span class=n>recorder</span><span class=p>,</span> <span class=n>beep_guard</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;识别文本：&#34;</span><span class=p>,</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>player</span><span class=o>.</span><span class=n>play_voice</span><span class=p>(</span><span class=n>block</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;ok&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 在这里根据 text 执行动作...</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>player</span><span class=o>.</span><span class=n>play_voice</span><span class=p>(</span><span class=n>block</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;sorry&#34;</span><span class=p>)</span>
</span></span></code></pre></div><hr><h2 id=-故障排查>🧯 故障排查<a hidden class=anchor aria-hidden=true href=#-故障排查>#</a></h2><ul><li><strong>没有反应 / 设备占用</strong>：检查是否有其他应用占用麦克风；尝试在系统声音设置中启用设备。</li><li><strong>识别慢</strong>：试用更小的 fast-whisper 模型或关闭其他高占用程序。</li><li><strong>唤醒不灵敏</strong>：更换更清晰的唤醒词模型 <code>.ppn</code>，或在安静环境下测试。</li><li><strong>提示音被识别进去</strong>：增大 <code>beep_guard</code>（如 <code>0.7</code>）。</li></ul><hr><h2 id=-致谢>🙌 致谢<a hidden class=anchor aria-hidden=true href=#-致谢>#</a></h2><ul><li><a href=https://picovoice.ai/>Picovoice Porcupine</a>（本地唤醒）</li><li><a href=https://github.com/guillaumekln/faster-whisper>fast-whisper</a>（快速 ASR）</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/%E6%9D%82%E8%AE%B0/>杂记</a></li><li><a href=http://localhost:1313/tags/%E9%A1%B9%E7%9B%AE/>项目</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/9%E6%9C%885%E6%97%A5%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/><span class=title>« Prev</span><br><span>9.5 论文阅读</span>
</a><a class=next href=http://localhost:1313/posts/the_science_of_well-being_%E6%80%BB%E7%BB%93/><span class=title>Next »</span><br><span>耶鲁大学幸福科学课程总结</span></a></nav></footer><div class=comments-title id=tw-comment-title><p class=x-comments-title>欢迎来到评论区</p><p style=font-size:1rem>感谢您的耐心阅读！来选个表情，或者留个评论吧！</p></div><div id=tw-comment></div><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"wanghai673/wanghai673.github.io","data-repo-id":"R_kgDOPfU1mg","data-category":"Announcements","data-category-id":"DIC_kwDOPfU1ms4CuRXc","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":getStoredTheme(),"data-lang":"zh-CN","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#tw-comment").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Wanghai673 | 博客</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>